"use strict";(self.webpackChunkjupyterlab_jupytext=self.webpackChunkjupyterlab_jupytext||[]).push([[568],{568:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0});const a=o(303),n=o(299),r=o(460),i=o(127),l=o(759),d=o(720),u=o(546),c=["ipynb","md","Rmd","qmd"];let s=!0;function m(t){var e,o;if(!t.currentWidget)return[];let a=function(t){var e;if(!t.currentWidget)return[];const o=t.currentWidget.context.model,a=s?o.getMetadata("jupytext"):null===(e=o.metadata)||void 0===e?void 0:e.get("jupytext");return a?(a&&a.formats?a.formats.split(","):[]).filter((function(t){return""!==t})):[]}(t);const n=t.currentWidget.context.model,r=s?n.getMetadata("language_info"):null===(e=n.metadata)||void 0===e?void 0:e.get("language_info");if(r&&r.file_extension){const t=r.file_extension.substring(1);a=a.map((function(e){return e===t?"auto:light":e.replace(t+":","auto:")}))}let i=t.currentWidget.context.path.split(".").pop();if(!i)return a;i=-1==c.indexOf(i)?"auto":i;for(const t in a)if(a[t].split(":")[0]==i)return a;if(-1!=c.indexOf(i))a.push(i);else{let e="light";const n=t.currentWidget.context.model,r=s?n.getMetadata("jupytext"):null===(o=n.metadata)||void 0===o?void 0:o.get("jupytext");r&&r.text_representation&&r.text_representation.format_name&&(e=r.text_representation.format_name),a.push("auto:"+e)}return a}const p={id:"jupyterlab-jupytext",autoStart:!0,optional:[d.ITranslator,a.ICommandPalette],requires:[i.NotebookPanel.IContentFactory,r.IEditorServices,l.IRenderMimeRegistry,a.ISessionContextDialogs,i.INotebookWidgetFactory,i.INotebookTracker,n.ISettingRegistry,a.IToolbarWidgetRegistry,a.ICommandPalette,d.ITranslator],activate:(t,e,o,n,r,l,p,f,g,y,b)=>{var _,x,k;if("JupyterLab"==t.name){const e=t.version.match(/[0-9]+/);e&&(s=parseInt(e[0])>=4)}console.log("JupyterLab extension jupytext is activating..."),console.debug(`bundled jupytext labextension: JLAB4=${s}`);const h=(null!=b?b:d.nullTranslator).load("jupytext"),v=function(t){return[{format:"ipynb",label:t.__("Pair Notebook with ipynb document")},{format:"auto:light",label:t.__("Pair Notebook with light Script")},{format:"auto:percent",label:t.__("Pair Notebook with percent Script")},{format:"auto:hydrogen",label:t.__("Pair Notebook with Hydrogen Script")},{format:"auto:nomarker",label:t.__("Pair Notebook with nomarker Script")},{format:"md",label:t.__("Pair Notebook with Markdown")},{format:"md:myst",label:t.__("Pair Notebook with MyST Markdown")},{format:"Rmd",label:t.__("Pair Notebook with R Markdown")},{format:"qmd",label:t.__("Pair Notebook with Quarto (qmd)")},{format:"custom",label:t.__("Custom pairing")},{format:"none",label:t.__("Unpair Notebook")}]}(h);let j;if(v.forEach(((e,o)=>{const n=e.format,r="jupytext:"+n;t.commands.addCommand(r,{label:e.label,isToggled:()=>{if(!p.currentWidget)return!1;const t=m(p);if("custom"==n){for(const e in t){const o=t[e];if(-1==["ipynb","auto:light","auto:percent","auto:hydrogen","auto:nomarker","md","Rmd","qmd","md:myst"].indexOf(o))return!0}return!1}return-1!=t.indexOf(n)},isEnabled:()=>{if(!p.currentWidget)return!1;const t=p.currentWidget.context.path.split(".").pop();return n!==t&&("none"!==n||m(p).length>1)},execute:()=>{var t,e;if(null===p.currentWidget)return;const o=p.currentWidget.context.model,i=s?o.getMetadata("jupytext"):null===(t=o.metadata)||void 0===t?void 0:t.get("jupytext");let l=m(p);if(console.log("Jupytext: executing command="+r),"custom"==n)return void a.showErrorMessage(h.__("Error"),h.__("Please edit the notebook metadata directly if you wish a custom configuration."));let d=p.currentWidget.context.path.split(".").pop();d=-1==c.indexOf(d)?"auto":d;const u=l.indexOf(n);if("none"===n)for(const t in l){const e=l[t];if(e.split(":")[0]===d){l=[e];break}}else if(-1!=u){l.splice(u,1);let t=!1;for(const e in l)if(l[e].split(":")[0]===d){t=!0;break}if(!t)return}else{const t=[];for(const e in l){const o=l[e];o.split(":")[0]!==n.split(":")[0]&&t.push(o)}l=t,l.push(n)}if(1===l.length)if("auto"!==d)l=[];else if(i&&i.text_representation){const t=l[0].split(":")[1];i.text_representation.format_name=t,l=[]}if(0!==l.length)if(i)i.formats=l.join();else{const t=p.currentWidget.context.model;s?t.setMetadata("jupytext",{formats:l.join()}):null===(e=t.metadata)||void 0===e||e.set({formats:l.join()})}else{if(!i)return;if(i.formats&&delete i.formats,0==Object.keys(i).length){const t=p.currentWidget.context.model;s?t.deleteMetadata("jupytext"):t.metadata.delete("jupytext")}}}}),console.log("Jupytext: adding command="+r+" with rank="+(o+1)),null==y||y.addItem({command:r,rank:o+2,category:"Jupytext"})})),null==y||y.addItem({args:{text:h.__("Jupytext Reference"),url:"https://jupytext.readthedocs.io/en/latest/"},command:"help:open",category:"Jupytext",rank:0}),null==y||y.addItem({args:{text:h.__("Jupytext FAQ"),url:"https://jupytext.readthedocs.io/en/latest/faq.html"},command:"help:open",category:"Jupytext",rank:1}),t.commands.addCommand("jupytext_metadata",{label:h.__("Include Metadata"),isToggled:()=>{var t;if(!p.currentWidget)return!1;const e=p.currentWidget.context.model,o=s?e.getMetadata("jupytext"):null===(t=e.metadata)||void 0===t?void 0:t.get("jupytext");return!!o&&"-all"!==o.notebook_metadata_filter},isEnabled:()=>{var t;if(!p.currentWidget)return!1;const e=p.currentWidget.context.model,o=s?e.getMetadata("jupytext"):null===(t=e.metadata)||void 0===t?void 0:t.get("jupytext");if(!o)return!1;const a=o;return void 0===a.notebook_metadata_filter||"-all"===a.notebook_metadata_filter},execute:()=>{var t;if(console.log("Jupytext: toggling YAML header"),!p.currentWidget)return;const e=p.currentWidget.context.model,o=s?e.getMetadata("jupytext"):null===(t=e.metadata)||void 0===t?void 0:t.get("jupytext");if(!o)return!1;const a=o;if(a.notebook_metadata_filter)return delete a.notebook_metadata_filter,void("-all"===a.cell_metadata_filter&&delete a.cell_metadata_filter);a.notebook_metadata_filter="-all",void 0===a.cell_metadata_filter&&(a.cell_metadata_filter="-all")}}),null==y||y.addItem({command:"jupytext_metadata",rank:v.length+3,category:"Jupytext"}),t.docRegistry.addFileType({name:"myst",displayName:h.__("MyST Markdown Notebook"),extensions:[".myst",".mystnb",".mnb"],icon:u.markdownIcon}),t.docRegistry.addFileType({name:"r-markdown",displayName:h.__("R Markdown Notebook"),extensions:[".rmd"],icon:u.markdownIcon}),t.docRegistry.addFileType({name:"quarto",displayName:h.__("Quarto Notebook"),extensions:[".qmd"],icon:u.markdownIcon}),s){const t="Notebook",e="@jupyterlab/notebook-extension:panel";j=a.createToolbarFactory(g,f,t,e,b)}else j=l.toolbarFactory;const w=new i.NotebookWidgetFactory({name:"Jupytext Notebook",label:h.__("Jupytext Notebook"),fileTypes:["markdown","myst","r-markdown","quarto","julia","python","r"],modelName:null!==(_=l.modelName)&&void 0!==_?_:"notebook",preferKernel:null===(x=l.preferKernel)||void 0===x||x,canStartKernel:null===(k=l.canStartKernel)||void 0===k||k,rendermime:n,contentFactory:e,editorConfig:l.editorConfig,notebookConfig:l.notebookConfig,mimeTypeService:o.mimeTypeService,toolbarFactory:j});t.docRegistry.addWidgetFactory(w);let N=0;const W=t.docRegistry.getFileType("notebook");w.widgetCreated.connect(((t,e)=>{var o,a;e.id=e.id||"notebook-jupytext-"+ ++N,e.title.icon=null==W?void 0:W.icon,e.title.iconClass=null!==(o=null==W?void 0:W.iconClass)&&void 0!==o?o:"",e.title.iconLabel=null!==(a=null==W?void 0:W.iconLabel)&&void 0!==a?a:"",e.context.pathChanged.connect((()=>{p.save(e)})),p.add(e)}))}};e.default=p}}]);